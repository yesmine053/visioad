[file name]: test_recaptcha.html (corrig√©)
[file content begin]
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test reCAPTCHA VisioAD</title>
    <script src="https://www.google.com/recaptcha/api.js?render=6Lfw3lUsAAAAAMEuauAsDM9SaCTd1GFUUgJ222v9"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 600px; margin: 50px auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: bold; color: #333; }
        input, textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-size: 16px; }
        input:focus, textarea:focus { border-color: #d12127; outline: none; box-shadow: 0 0 0 3px rgba(209, 33, 39, 0.1); }
        button { background: #d12127; color: white; padding: 15px 30px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; font-weight: bold; width: 100%; }
        button:hover { background: #b81c22; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        .success { color: #155724; background: #d4edda; padding: 15px; border-radius: 5px; border: 1px solid #c3e6cb; margin-top: 20px; }
        .error { color: #721c24; background: #f8d7da; padding: 15px; border-radius: 5px; border: 1px solid #f5c6cb; margin-top: 20px; }
        .debug { background: #f8f9fa; padding: 15px; border-radius: 5px; border: 1px solid #e9ecef; margin-top: 20px; font-family: monospace; font-size: 12px; }
        h1 { color: #d12127; text-align: center; margin-bottom: 30px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Test reCAPTCHA VisioAD</h1>
        
        <form id="contactForm">
            <div class="form-group">
                <label for="name">Nom *</label>
                <input type="text" id="name" name="name" required placeholder="Votre nom">
            </div>
            
            <div class="form-group">
                <label for="email">Email *</label>
                <input type="email" id="email" name="email" required placeholder="votre@email.com">
            </div>
            
            <div class="form-group">
                <label for="phone">T√©l√©phone (optionnel)</label>
                <input type="tel" id="phone" name="phone" placeholder="+216 XX XXX XXX">
            </div>
            
            <div class="form-group">
                <label for="subject">Sujet (optionnel)</label>
                <input type="text" id="subject" name="subject" placeholder="Sujet de votre message">
            </div>
            
            <div class="form-group">
                <label for="message">Message *</label>
                <textarea id="message" name="message" rows="5" required placeholder="D√©crivez votre projet..."></textarea>
            </div>
            
            <button type="submit" id="submitBtn">üì® Envoyer le message</button>
            
            <div id="result" style="margin-top: 20px;"></div>
            
            <!-- Debug panel -->
            <div class="debug" id="debugPanel" style="display: none;">
                <h4>Debug Information:</h4>
                <pre id="debugInfo"></pre>
            </div>
            
            <div style="margin-top: 20px; font-size: 12px; color: #666; text-align: center;">
                Ce site est prot√©g√© par reCAPTCHA et la 
                <a href="https://policies.google.com/privacy" target="_blank">Politique de confidentialit√©</a> et les
                <a href="https://policies.google.com/terms" target="_blank">Conditions d'utilisation</a> de Google s'appliquent.
            </div>
        </form>
    </div>

    <script>
        document.getElementById('contactForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const resultDiv = document.getElementById('result');
            const debugPanel = document.getElementById('debugPanel');
            const debugInfo = document.getElementById('debugInfo');
            
            submitBtn.disabled = true;
            submitBtn.textContent = '‚è≥ Envoi en cours...';
            resultDiv.innerHTML = '';
            debugPanel.style.display = 'none';
            
            try {
                console.log('D√©but de l\'envoi du formulaire...');
                
                // 1. Obtenir le token reCAPTCHA
                console.log('Obtention du token reCAPTCHA...');
                const token = await grecaptcha.execute(
                    '6Lfw3lUsAAAAAMEuauAsDM9SaCTd1GFUUgJ222v9',
                    { action: 'contact' }
                );
                
                console.log('Token reCAPTCHA obtenu:', token.substring(0, 20) + '...');
                
                // 2. R√©cup√©rer les donn√©es du formulaire
                const formData = {
                    name: document.getElementById('name').value,
                    email: document.getElementById('email').value,
                    phone: document.getElementById('phone').value,
                    subject: document.getElementById('subject').value,
                    message: document.getElementById('message').value,
                    recaptcha_token: token
                };
                
                console.log('Donn√©es du formulaire:', formData);
                
                // 3. Envoyer √† l'API
                console.log('Envoi vers l\'API...');
                const response = await fetch('http://localhost:8080/Visioad/contact.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });
                
                console.log('R√©ponse re√ßue, statut:', response.status);
                
                const responseText = await response.text();
                console.log('Texte de r√©ponse:', responseText);
                
                let result;
                try {
                    result = JSON.parse(responseText);
                    console.log('JSON pars√©:', result);
                } catch (parseError) {
                    console.error('Erreur parsing JSON:', parseError);
                    throw new Error('R√©ponse serveur invalide: ' + responseText.substring(0, 100));
                }
                
                // Afficher les infos de debug
                debugInfo.textContent = JSON.stringify({
                    request: formData,
                    response: result,
                    timestamp: new Date().toISOString()
                }, null, 2);
                debugPanel.style.display = 'block';
                
                if (result.success) {
                    resultDiv.className = 'success';
                    resultDiv.innerHTML = `‚úÖ ${result.message} ${result.contact_id ? '(ID: ' + result.contact_id + ')' : ''}`;
                    document.getElementById('contactForm').reset();
                } else {
                    resultDiv.className = 'error';
                    let errorMessage = `‚ùå ${result.message}`;
                    if (result.debug) {
                        errorMessage += `<br><small>Debug: ${result.debug}</small>`;
                    }
                    if (result.recaptcha_error) {
                        errorMessage += `<br><small>reCAPTCHA: ${JSON.stringify(result.recaptcha_error)}</small>`;
                    }
                    resultDiv.innerHTML = errorMessage;
                }
                
            } catch (error) {
                console.error('Erreur compl√®te:', error);
                resultDiv.className = 'error';
                resultDiv.innerHTML = `‚ùå Erreur: ${error.message}`;
                
                debugInfo.textContent = JSON.stringify({
                    error: error.message,
                    timestamp: new Date().toISOString()
                }, null, 2);
                debugPanel.style.display = 'block';
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'üì® Envoyer le message';
            }
        });
        
        // Charger reCAPTCHA
        grecaptcha.ready(function() {
            console.log('‚úÖ reCAPTCHA charg√© avec succ√®s');
            document.getElementById('submitBtn').style.display = 'block';
        });
    </script>
</body>
</html>
[file content end]